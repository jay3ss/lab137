<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Lab137 - print</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="/theme/css/main.3dad1b7a.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
      <link rel="stylesheet" href="/css/custom.css">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="navbar">
        <div class="navbar-brand">
          <a class="navbar-item title is-3"
             href="/">Lab137</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="navbar has-shadow is-hidden-print">
  <div class="container">
    <div class="navbar-center"></div>
    <span id="navToggle" class="navbar-burger">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
              <a class="navbar-item is-tab "
                 href="/categories/articles/">articles</a>
        </div>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <div class="column is-three-quarters-desktop is-two-thirds-tablet">
      <aside id="featured" class="body">
        <article>
          <h1 class="title">
            <a href="/articles/how-to-print-on-the-same-line-with-python/">How to Print on the Same Line with Python</a>
          </h1>
<footer class="post-info">
  <abbr class="published" title="2019-12-17T16:00:00-08:00">
    Published <span class="is-info">Tue 17 December 2019</span>
    in <a href="/categories/articles/">articles</a>
  </abbr>
    <br />
    <abbr class="modified" title="2020-05-01T15:51:00-07:00">
      Updated Fri 01 May 2020
    </abbr>

    <p class="author">
      <em>by           <a class="url fn" href="/author/jay-ess/">Jay Ess</a>
</em>
      <span class="tag is-small is-rounded">
        <a href="/tags/python/">python</a>
      </span>
      <span class="tag is-small is-rounded">
        <a href="/tags/print/">print</a>
      </span>
    </p>
  
</footer>          <div class="section">
              <p>Today, I was downloading about 1,600 images and wanted to be able to keep track
of how many images I had downloaded so far and what image that I was currently
downloading. This is typically very easy with Python, but I decided to print
everything on the same line so that I my terminal wouldn't get cluttered with
<code>print</code> statements. This is where I encountered my issue.</p>
<p>The format of the string that I was printing started out as</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">Image</span><span class="se">\t</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

<p>where</p>
<ul>
<li><code>\r</code>: is the carriage return which resets the line position to the beginning
of the line</li>
<li><code>count</code>: the number of the image that I was downloading</li>
<li><code>end</code>: the character that <code>print</code> will append to the string that it's printing</li>
<li><code>flush</code>: tells <code>print</code> whether or not it should forcibly flush the stream</li>
</ul>
<p>Basically, what's going to happen is that when the string is printed it will
print the string and put the cursor back at the beginning of the line. If this
where done in a loop (probably using <code>time.sleep</code> too), then you'd get the
effect of the one line counting up. Neat!</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">Count</span><span class="se">\t</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

<p>We can put this into a function to make it a little easier to read</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">print_same_line</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

<p>In the function above, we need to use the <code>sep</code> keyword so that when we use
this function a space isn't added between the <code>\r</code> character and our string
causing an offset. Now we can use a loop like above and have our code be a bit
more readable (we also don't need the <code>\r</code> character at the beginning of our
string).</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">print_same_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Count</span><span class="se">\t</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div>

<p>This worked pretty great, but I encountered trouble when I was reading URLs
from a file and was printing them to the terminal.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">urllib.request</span> <span class="k">as</span> <span class="nn">request</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)</span>
<span class="n">SLEEP</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># seconds</span>
<span class="n">urls_file</span> <span class="o">=</span> <span class="s1">&#39;images.txt&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">urls_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;Image&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()])</span>
        <span class="n">print_same_line</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">fname</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="n">fname</span><span class="p">)</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SLEEP</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Done! Downloaded </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1"> images&#39;</span><span class="p">)</span>
</code></pre></div>

<p>which resulted in the unexpected output of</p>
<div class="highlight"><pre><span></span><code>Image<span class="w">   </span><span class="m">1</span><span class="w">   </span>https://example.com/image-1.jpg
Image<span class="w">   </span><span class="m">2</span><span class="w">   </span>https://example.com/image-2.jpg
Image<span class="w">   </span><span class="m">3</span><span class="w">   </span>https://example.com/image-3.jpg
Image<span class="w">   </span><span class="m">4</span><span class="w">   </span>https://example.com/image-4.jpg
Image<span class="w">   </span><span class="m">5</span><span class="w">   </span>https://example.com/image-5.jpg
Image<span class="w">   </span><span class="m">6</span><span class="w">   </span>https://example.com/image-6.jpg
...
</code></pre></div>

<p>It took me longer than I'd like to admit to figure out what went wrong. If you
look at the line where I grab the file name (<code>fname</code>) from the URL, you'll see
that I call the <code>strip</code> method. Why? Each line of the file had a <code>\n</code> character
at the end of it. Even though I did it for the file name I <strong>did not</strong> do it
for the printing of the URL. This one little mistake cost me probably 90 to 120
minutes...</p>
<p>Once I fixed it, however, it worked like a charm. Below is the fixed example</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">urllib.request</span> <span class="k">as</span> <span class="nn">request</span>


<span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)</span>
<span class="n">SLEEP</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># seconds</span>
<span class="n">urls_file</span> <span class="o">=</span> <span class="s1">&#39;images.txt&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">urls_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">urls</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">print_same_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Image</span><span class="se">\t</span><span class="si">{</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">fname</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="n">fname</span><span class="p">)</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SLEEP</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Done! Downloaded </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s1"> images&#39;</span><span class="p">)</span>
</code></pre></div>
          </div>
        </article>
      </aside>
    </div>

    <div class="column is-one-quarter-desktop is-one-third-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Other Pages</p>
          <ul class="menu-list">
                <li><a                        href="/pages/about/">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">About</span>
                </a></li>
                <li><a                        href="/pages/privacy-policy/">
                  <span class="icon is-small"><i class="fa fa-book"></i></span>
                  <span class="link-text">Privacy Policy</span>
                </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="https://www.linkedin.com/in/jsaundersee">
      <span class="icon is-small">
          <i class="fa fa-linkedin fa-fw"></i>
      </span>
      <span class="link-text">LinkedIn</span>
    </a></li>
    <li><a href="https://github.com/jay3ss">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text">GitHub</span>
    </a></li>


</ul>          <p class="menu-label">License</p>
          
<ul class="menu-list">
  <li>
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
      <span class="icon is-small">
        <i class="fa fa-creative-commons fa-fw"></i>
      </span>
      <span>CC BY-SA 4.0</span>
    </a>
  </li>
</ul>

      </aside>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="container has-text-centered">
    <div class="credits">
      <span><a href="https://github.com/textbook/bulrush">Bulrush</a> theme for
        <a href="https://blog.getpelican.com/">Pelican</a></span>
      <span><span class="icon is-small"><i class="fa fa-html5"></i></span> HTML 5</span>
      <span><span class="icon is-small"><i class="fa fa-css3"></i></span> CSS 3</span>
      <span>Made with <a href="https://bulma.io">Bulma</a></span>
    </div>
  </div>
</footer>

<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'navbar-menu') {
      nav.className = 'navbar-menu is-active';
    } else {
      nav.className = 'navbar-menu';
    }
  });
</script>
</body>
</html>